<div class="col-sm-12">
    <mat-card>
        <mat-card-header>
            <mat-card-title>Assign Subject</mat-card-title>
        </mat-card-header>

        <form [formGroup]="assignSubjectForm" (ngSubmit)="addSubject()">
            <mat-card-content>
                <div class="form-field-full">
                    <div class="row">
                        <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select Session</mat-label>
                                <!-- <mat-select formControlName="subjectType" (selectionChange)="getSubjectList()"> -->
                                <mat-select formControlName="sessionId" (selectionChange)="loadClassList()">
                                    @for (session of sessions; track session.sessionId) {
                                    <mat-option [value]="session.sessionId">
                                        {{ session.sessionName }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select School</mat-label>
                                <mat-select formControlName="collegeId" (selectionChange)="loadClassList()">
                                    @for (college of colleges; track college.collegeId) {
                                    <mat-option [value]="college.collegeId">
                                        {{ college.collegeAbreviation }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select Class</mat-label>
                                <mat-select formControlName="courseId">
                                    @for (class of classList; track class.collegeId) {
                                    <mat-option [value]="class.courseId">
                                        {{ class.courseName }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                          <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select Section</mat-label>
                                <mat-select formControlName="classSectionId" (selectionChange)="getAssignSubjectList()">
                                    @for (college of sectionList; track college.sectionId) {
                                    <mat-option [value]="college.sectionId">
                                        {{ college.sectionName }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                         <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select Subject Type</mat-label>
                                <mat-select formControlName="subjectType" (selectionChange)="getSubjectList()" >
                                    @for (subType of subjectTypeList; track subType.type) {
                                    <mat-option [value]="subType.type">
                                        {{ subType.detail }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3">
                            <mat-form-field appearance="fill" class="w-100">
                                <mat-label>Select Subject</mat-label>
                                <mat-select formControlName="subjectId" multiple>
                                    @for (subject of subjectList; track subject.subjectId) {
                                    <mat-option [value]="subject.subjectId">
                                        {{ subject.subjectName }}
                                    </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="m-t-8">
                        <button mat-flat-button color="primary" type="submit">Save</button>
                        <button mat-button class="m-x-8" type="button" (click)="onCancel()">Cancel</button>
                    </div>
                </div>
            </mat-card-content>
        </form>
    </mat-card>
</div>



<div class="col-sm-12 mt-3">
    <mat-card>
        <mat-card-content>

            <mat-form-field appearance="fill">
                <mat-label>Search</mat-label>
                <input matInput (keyup)="applyFilter($event)" placeholder="Search subjects" />
            </mat-form-field>

            @if (dataSource.data.length > 0) {
            <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 w-100">

                <ng-container matColumnDef="subjectCode">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Subject Code</th>
                    <td mat-cell *matCellDef="let element">{{ element.subjectCode }}</td>
                </ng-container>

                <ng-container matColumnDef="subjectName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Subject Name</th>
                    <td mat-cell *matCellDef="let element">{{ element.subjectName }}</td>
                </ng-container>

                <ng-container matColumnDef="subjectType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>
                    <td mat-cell *matCellDef="let element">{{ element.subjectType }}</td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>Actions</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button color="primary" (click)="deleteAssignSub(element)">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
            } @else {
            <p class="text-center text-muted mt-2">No reocrd found.</p>
            }

        </mat-card-content>
    </mat-card>
</div>